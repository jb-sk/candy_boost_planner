/* --- Export sheet (SNS screenshot) --- */
.exportOverlay {
  position: fixed;
  inset: 0;
  z-index: 50;
  padding: 18px;
  background: color-mix(in oklab, var(--ink) 28%, transparent);
  display: grid;
  place-items: center;
}

.exportSheetWrap {
  width: min(820px, calc(100vw - 36px));
  max-height: calc(100vh - 36px);
  overflow: auto;
}

.exportSheet {
  transform-origin: top center;
  width: 100%;
  border-radius: 4px;
  /* シャープに */
  background: #ffffff;
  /* Calc Panel Theme Match */
  --ink: #44403c;
  --muted: #a8a29e;
  --accent: #0ea5e9;
  /* Sky 500: テキスト・ヘッダー用 */
  --bar-fill: #ec4899;
  /* Pink 500: 使用量（ピンク） */
  --bar-track: #bae6fd;
  /* Sky 200: バー背景（水色） */
  --danger: #ef4444;
  /* Red 500 */

  /* 深みのあるドロップシャドウでプロ感を出す */
  box-shadow: 0 20px 25px -5px rgba(0, 0, 0, 0.1), 0 10px 10px -5px rgba(0, 0, 0, 0.04);
  padding: 40px;
  /* 余白を贅沢に */
  position: relative;
  font-family: var(--font-body);
  color: var(--ink);
}

.exportSheet--capture {
  border: 0;
  border-radius: 0;
  box-shadow: none;
  background: #ffffff;
}

/* Header: Report Style */
.exportHead {
  display: flex;
  justify-content: space-between;
  align-items: flex-end;
  border-bottom: 2px solid var(--ink);
  /* 強い区切り線 */
  padding-bottom: 16px;
  margin-bottom: 32px;
}

.exportHead__top {
  display: flex;
  text-align: left;
}

.exportMeta {
  position: relative;
  display: flex;
  align-items: baseline;
  /* ベースラインで揃える */
  gap: 16px;
  min-width: 0;
}

/* 年月表示: 右上に配置し、落ち着いた色味に */
.exportMonth {
  position: static;
  transform: none;
  font-family: var(--font-heading);
  font-weight: 700;
  letter-spacing: 0.05em;
  font-size: 14px;
  color: var(--muted);
  line-height: 1.5;
  /* margin-bottom 削除 */
}

.exportBrand {
  font-family: var(--font-heading);
  font-weight: 800;
  letter-spacing: -0.01em;
  font-size: 22px;
  /* タイトルを大きく */
  color: var(--ink);
  line-height: 1.1;
}

.exportActions {
  display: flex;
  gap: 12px;
  align-items: baseline;
}

.exportCsvMenuTrigger {
  position: relative;
  display: flex;
  align-items: center;
}

.exportCsvMenu {
  position: absolute;
  right: 0;
  top: calc(100% + 8px);
  z-index: 5;
  min-width: 180px;
  display: grid;
  gap: 4px;
  padding: 8px;
  border-radius: 6px;
  border: 1px solid #e2e8f0;
  background: #ffffff;
  box-shadow: 0 10px 15px -3px rgba(0, 0, 0, 0.1);
}

.exportCsvMenu__item {
  appearance: none;
  border: 0;
  width: 100%;
  text-align: left;
  cursor: pointer;
  font-size: 13px;
  padding: 8px 12px;
  border-radius: 4px;
  color: var(--ink);
  background: transparent;
}

.exportCsvMenu__item:hover {
  background: #f1f5f9;
  color: var(--accent);
}

.exportStatus {
  margin: 0 0 16px;
  font-size: 12px;
  color: var(--muted);
  text-align: right;
}

/* Export Styles */
.exportCalc {
  background: white;
  padding: 2px;
  display: flex;
  flex-direction: column;
}

/* Stats Area: Dashboard Style */
.exportStats {
  display: flex;
  justify-content: space-between;
  gap: 24px;
  margin: 0 0 32px;
  gap: 24px;
  margin: 0 0 32px;
  padding: 20px 24px;
  background: #f8fafc;
  /* 薄いグレー背景 */
  border-radius: 8px;
  border: 1px solid #e2e8f0;
}

.statCard {
  flex: 0 0 auto;
  display: flex;
  flex-direction: column;
  align-items: flex-start;
  gap: 6px;
  background: transparent;
  box-shadow: none;
  padding: 0;
  border: none;
  border-radius: 0;
}

/* アイコンは控えめに、あるいは削除してもいいが残す */
.statCard__icon {
  font-size: 16px;
  opacity: 0.8;
}

.statCard__content {
  min-width: 0;
}

.statCard__label {
  font-size: 11px;
  text-transform: uppercase;
  letter-spacing: 0.05em;
  color: var(--muted);
  font-weight: 600;
  margin-bottom: 2px;
}

.statCard__value {
  font-family: var(--font-heading);
  font-weight: 800;
  font-size: 28px;
  line-height: 1;
  color: var(--ink);
  font-variant-numeric: tabular-nums;
  /* 数字の幅を揃える */
}

.statCard__value--danger {
  color: var(--danger);
}

.statCard--danger .statCard__value {
  color: var(--danger);
}

/* Bars: Clean & Minimal */
.exportBars {
  background: transparent;
  border: none;
  box-shadow: none;
  padding: 0;
  margin: 0 0 40px;
  display: grid;
  gap: 20px;
}

.exportBars--muted {
  opacity: 0.8;
}

.exportBarHead {
  display: flex;
  align-items: baseline;
  justify-content: space-between;
  margin-bottom: 6px;
}

.exportBarK {
  font-size: 14px;
  color: var(--ink);
  font-weight: 700;
}

.exportBarK--right {
  font-size: 12px;
  color: var(--muted);
  font-weight: 500;
}

.exportBarOverVal {
  color: var(--danger);
  font-weight: 700;
  margin-left: 4px;
}

.exportBar {
  margin-top: 0;
}

.exportBar__track {
  position: relative;
  height: 8px;
  /* 少し細く */
  border-radius: 4px;
  background: var(--bar-track);
  /* 水色背景 */
  overflow: hidden;
}

.exportBar__fill {
  position: absolute;
  inset: 0 auto 0 0;
  width: 0%;
  border-radius: 4px;
  background: var(--bar-fill);
  /* ピンク */
}

.exportBarBlock--danger .exportBar__fill {
  background: linear-gradient(90deg, var(--danger) 0%, rgb(255, 100, 100) 100%);
}

/* Shards bar color: 同色（ピンク）にするため個別設定を削除 */
.exportBar__over {
  position: absolute;
  inset: 0 0 0 auto;
  width: 0%;
  background: repeating-linear-gradient(-45deg,
      rgba(239, 68, 68, 0.15) 0,
      rgba(239, 68, 68, 0.15) 6px,
      rgba(255, 255, 255, 0.5) 6px,
      rgba(255, 255, 255, 0.5) 12px);
}

/* List: Table Style (High Contrast) */
.exportList {
  display: flex;
  flex-direction: column;
  background: transparent;
  border-radius: 0;
  box-shadow: none;
  border: none;
  margin: 0;
  font-size: 13px;
}

.exportList__head {
  display: grid;
  grid-template-columns: 2fr 0.9fr 0.7fr 0.7fr 0.7fr 1.5fr;
  gap: 12px;
  padding: 12px 16px;
  background: color-mix(in oklab, var(--accent) 8%, white);
  /* 計算機と同じ水色背景 */
  color: var(--ink);
  /* 文字は黒ではっきり */
  border-bottom: 2px solid var(--accent);
  /* 青いライン */
  border-radius: 6px;
  font-family: var(--font-heading);
  font-weight: 700;
  font-size: 12px;
  letter-spacing: 0.05em;
  align-items: center;
  /* ヘッダーは中央揃えで見やすく */
}

.exportList__row {
  display: grid;
  grid-template-columns: 2fr 0.9fr 0.7fr 0.7fr 0.7fr 1.5fr;
  gap: 12px;
  padding: 12px 16px;
  align-items: center;
  /* 行内は中央揃えに戻す（罫線スタイルならずれてもOKだが、揃ってる方がプロっぽい） */
  border-bottom: 1px solid #e2e8f0;
}

.exportList__row:last-child {
  border-bottom: 2px solid var(--ink);
}

/* 最後の行（合計前）を区切る */

.exportList--hasShortage .exportList__head,
.exportList--hasShortage .exportList__row {
  grid-template-columns: 2fr 0.9fr 0.7fr 0.7fr 0.7fr 1.2fr 0.7fr;
}

.exportList__col {
  min-width: 0;
  font-weight: 500;
}

.exportList__col.u-align-right {
  text-align: right;
}

.exportList__col.u-align-center {
  text-align: center;
}

.exportList__nameCol {
  display: flex;
  align-items: center;
  gap: 8px;
  flex-wrap: wrap;
}

.exportList__name {
  font-weight: 700;
  font-size: 14px;
  color: var(--ink);
}

.exportList__badge {
  font-size: 10px;
  font-weight: 700;
  padding: 2px 6px;
  border-radius: 4px;
  background: #f1f5f9;
  color: var(--muted);
  border: 1px solid #e2e8f0;
}

.exportList__lvWrap {
  display: inline-flex;
  align-items: center;
  gap: 6px;
  font-weight: 700;
  background: transparent;
  padding: 0;
  color: var(--ink);
}

.exportList__arrow {
  color: var(--muted);
  font-size: 10px;
}

.exportList__numCol .exportList__num {
  font-size: 14px;
  font-family: var(--font-body);
  font-variant-numeric: tabular-nums;
  color: var(--ink);
}

.exportList__numCol .exportList__num--danger {
  color: var(--danger);
  font-weight: 700;
}

/* モバイルラベルはデスクトップでは非表示 */
.u-mobile-label {
  display: none;
}

.exportList__row--total {
  background: #f8fafc;
  border-bottom: none;
  font-weight: 700;
  border-radius: 0 0 6px 6px;
  margin-top: 4px;
}

/* Ranking */
.exportRanking {
  display: flex;
  flex-direction: column;
  background: white;
  border-radius: 6px;
  box-shadow: 0 4px 20px rgba(0, 0, 0, 0.06);
  border: 1px solid color-mix(in oklab, var(--ink) 6%, transparent);
  overflow: hidden;
  margin: 20px 10px 0;
  padding: 16px 18px;
}

.exportRanking__title {
  font-family: var(--font-heading);
  font-weight: 800;
  font-size: 16px;
  margin-bottom: 12px;
  display: flex;
  align-items: center;
  gap: 8px;
}

.exportRanking__title::before {
  content: "";
  display: block;
  width: 6px;
  height: 20px;
  background: var(--accent);
  border-radius: 3px;
}

.exportRanking__total {
  font-size: 13px;
  background: color-mix(in oklab, var(--accent) 8%, transparent);
  margin-bottom: 16px;
  padding: 10px 14px;
  border-radius: 8px;
  display: flex;
  align-items: center;
  gap: 16px;
  font-weight: 600;
}

.exportRanking__total span:first-child {
  color: color-mix(in oklab, var(--ink) 70%, transparent);
  font-weight: 700;
  font-size: 12px;
}

.exportRanking__list {
  display: flex;
  flex-direction: column;
  gap: 8px;
}

.exportRanking__item {
  display: grid;
  grid-template-columns: minmax(80px, 1.2fr) 40px 120px minmax(0, 3fr);
  gap: 0 12px;
  align-items: center;
  padding: 10px 6px;
  border-bottom: 1px solid color-mix(in oklab, var(--ink) 6%, transparent);
}

.exportRanking__item:last-child {
  border-bottom: none;
}

.exportRanking__name {
  font-family: var(--font-heading);
  font-weight: 700;
  font-size: 14px;
  overflow: hidden;
  text-overflow: ellipsis;
  white-space: nowrap;
  grid-column: 1 / 2;
  grid-row: 1 / 2;
}

.exportRanking__pct {
  font-family: var(--font-heading);
  font-weight: 700;
  font-size: 15px;
  text-align: right;
  grid-column: 2 / 3;
  grid-row: 1 / 2;
}

.exportRanking__barWrap {
  position: relative;
  height: 8px;
  background: color-mix(in oklab, var(--ink) 8%, transparent);
  border-radius: 4px;
  overflow: hidden;
  grid-column: 3 / 4;
  grid-row: 1 / 2;
}

.exportRanking__bar {
  position: absolute;
  inset: 0 auto 0 0;
  height: 100%;
  background: color-mix(in oklab, var(--accent-warm) 85%, var(--ink) 5%);
  border-radius: 4px;
  transition: width 240ms ease;
}

.exportRanking__items {
  grid-column: 4 / 5;
  grid-row: 1 / 2;
  display: flex;
  gap: 8px;
  flex-wrap: nowrap;
  font-size: 13px;
  color: color-mix(in oklab, var(--ink) 60%, transparent);
  margin-top: 0;
  overflow: hidden;
  white-space: nowrap;
  text-overflow: ellipsis;
}

.exportRanking__itemGroup {
  display: inline-flex;
  gap: 3px;
  align-items: center;
  font-weight: 700;
  font-size: 14px;
  color: var(--ink);
}

.exportRanking__itemLabel {
  display: inline-block;
  font-size: 11px;
  font-weight: 700;
  color: color-mix(in oklab, var(--ink) 70%, transparent);
  background-color: color-mix(in oklab, var(--ink) 6%, transparent);
  padding: 1px 6px;
  border-radius: 4px;
  line-height: 1.4;
}

/* Mobile Responsive */
@media (max-width: 560px) {

  /* Full Screen Overlay */
  .exportOverlay {
    padding: 0;
    display: block;
    /* grid center 解除 */
    overflow: hidden;
    /* Wrapでスクロールさせる */
  }

  .exportSheetWrap {
    width: 100%;
    height: 100%;
    max-height: none;
    border-radius: 0;
  }

  .exportSheet {
    width: 100%;
    min-height: 100%;
    border-radius: 0;
    box-shadow: none;
    padding: 20px 16px;
  }

  .exportHead {
    flex-direction: column;
    align-items: flex-start;
    gap: 16px;
    margin-bottom: 24px;
    border-bottom: 1px solid #e2e8f0;
  }

  /* ブランド名は大きく */
  .exportBrand {
    font-size: 20px;
  }

  .exportMeta {
    width: 100%;
    justify-content: space-between;
    margin-top: 4px;
  }

  /* Stats: 2カラム折り返し */
  .exportStats,
  .exportStats--normal {
    flex-wrap: wrap;
    gap: 16px;
    justify-content: flex-start;
  }

  .statCard,
  .exportStats--normal>.statCard {
    flex: 0 0 calc(50% - 9px);
    /* 2列 */
    min-width: 0;
    align-items: flex-start;
    text-align: left;
  }

  .statCard__value {
    font-size: 22px;
  }

  /* List: Compact List View (No Tiles) */
  .exportList__head {
    display: none;
  }

  .exportList__row,
  .exportList--normal .exportList__row,
  .exportList--hasShortage .exportList__row,
  .exportList--normal.exportList--hasShortage .exportList__row {
    display: grid;
    /* 4カラム均等割で縦のラインを揃える */
    grid-template-columns: repeat(4, 1fr);
    gap: 4px 8px;
    padding: 10px 4px;
    border: none;
    border-bottom: 1px solid #e2e8f0;
    border-radius: 0;
    margin-bottom: 0;
    background: transparent;
    box-shadow: none;
  }

  .exportList__nameCol {
    grid-column: 1 / 4;
    border-bottom: none;
    padding-bottom: 0;
    margin-bottom: 0;
  }

  .exportList__name {
    font-size: 14px;
  }

  .exportList__badge {
    scale: 0.9;
    transform-origin: left center;
  }

  .exportList__lvCol {
    grid-column: 4 / -1;
    justify-content: flex-end;
    font-size: 12px;
  }

  /* 数値カラム: 2行目以降に自動配置 (span 1) */
  .exportList__col.u-align-right,
  .exportList__col.u-align-center {
    text-align: left;
    display: flex;
    flex-direction: column;
    /* 値とラベルを縦積み、あるいは横並び？横並びにして省スペース化 */
    align-items: flex-start;
    grid-column: span 1;
    /* 1行に4つ並ぶ */
  }

  /* ラベルと値をコンパクトに */
  .u-mobile-label {
    display: block;
    font-size: 9px;
    margin-bottom: 0px;
    background: transparent;
    border: none;
    padding: 0;
    color: var(--muted);
  }

  .exportList__num {
    font-size: 13px;
  }

  /* Total Row: Grid Layout (Match Data Row) */
  .exportList__row--total {
    display: grid;
    grid-template-columns: repeat(4, 1fr);
    /* データ行と一致させる */
    gap: 4px 8px;
    background: #f8fafc;
    border-top: 1px solid #e2e8f0;
    /* データ行と同じpaddingにする */
    padding: 10px 4px;
    margin-bottom: 0;
    border-radius: 0;
  }

  /* Total行の空カラム（名前・Lv）は非表示 */
  .exportList__row--total .exportList__nameCol,
  .exportList__row--total .exportList__lvCol {
    display: none;
  }

  /* 数値カラムのスタイル調整: コントラスト強化 */
  .exportList__row--total .exportList__numCol {
    width: auto;
    display: flex;
    flex-direction: column;
    align-items: flex-start;
    grid-column: span 1;
  }

  .exportList__row--total .exportList__num {
    /* 太字にはしない */
    color: #0f172a;
    /* Slate 900 */
  }

  .exportList__row--total .u-mobile-label {
    text-align: left;
    color: var(--ink);
    /* MutedではなくInk */
    /* 太字にはしない */
    opacity: 0.9;
    /* 視認性確保のため不透明度のみ上げる */
  }

  .exportRanking__item {
    grid-template-columns: 1fr auto;
    grid-template-rows: auto auto auto;
    gap: 6px 12px;
    padding: 12px 6px;
  }

  .exportRanking__name {
    grid-column: 1 / 2;
    grid-row: 1 / 2;
    font-size: 13px;
  }

  .exportRanking__pct {
    grid-column: 2 / 3;
    grid-row: 1 / 2;
  }

  .exportRanking__barWrap {
    display: block;
    grid-column: 1 / 3;
    grid-row: 2 / 3;
    height: 6px;
  }

  .exportRanking__items {
    grid-column: 1 / 3;
    grid-row: 3 / 4;
    flex-wrap: wrap;
    white-space: normal;
    font-size: 11px;
    gap: 8px;
  }
}

/* When capturing PNG, never include action links in the exported image */
/* --- Normal Mode Adjustments --- */
.exportStats--normal {
  display: flex;
  gap: 12px;
}

.exportStats--normal>.statCard {
  flex: 1;
  min-width: 0;
  justify-content: center;
  text-align: center;
}

.exportStats--normal .statCard__icon {
  display: none;
}

/* 通常モード（4列）: Pokemon, Lv, Total, Shards */
.exportList--normal .exportList__head,
.exportList--normal .exportList__row {
  grid-template-columns: 2fr 1fr 1fr 1.5fr;
  padding-left: 32px;
  padding-right: 32px;
}

/* 通常モード+アメ不足（5列）: Pokemon, Lv, Total, Shards, Shortage */
.exportList--normal.exportList--hasShortage .exportList__head,
.exportList--normal.exportList--hasShortage .exportList__row {
  grid-template-columns: 2fr 1fr 1fr 1.2fr 0.8fr;
}

.exportSheet--capture .exportActions {
  display: none;
}
